<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">시험 보기</title>
    <link rel="stylesheet" th:href="@{/css/header.css}" />
    <link rel="stylesheet" th:href="@{/css/quizTest.css}" />
    <link rel="stylesheet" th:href="@{/css/footer.css}" />
</head>
<body>
    <!-- 헤더 -->
    <div th:replace="fragments/header :: siteHeader"></div>

    <div class="full-location-container">
        <div class="full-container">
            <!-- 문제 헤더 -->
            <div class="quiz-header">
                <div class="left-arrow"><img id="prevBtn" th:src="@{/images/arrowVector.svg}" class="arrow1"/></div>
                <div id="quizNumber" class="quiz-number">1/20</div>
                <div id="quizTitle" class="quiz-title">문제</div>
                <div class="right-arrow"><img id="nextBtn" th:src="@{/images/arrowVector.svg}" class="arrow2"/></div>
            </div>

            <!-- 문제 텍스트 -->
            <div class="quiz-text-container">
                <div id="quizText" class="quiz-text">문제가 표시됩니다.</div>
            </div>

            <!-- 답안 영역 -->
            <div id="quizAnswerContainer" class="quiz-answer-container"></div>

            <!-- 제출 버튼 -->
            <div class="submit-container">
                <button id="submitBtn" class="submit-btn">제출</button>
            </div>
        </div>
    </div>

    <!-- footer -->
    <div th:replace="fragments/footer :: siteFooter"></div>

    <!-- JS 변수 전달 -->
   <script th:inline="javascript">
		/*<![CDATA[*/
		let questions = /*[[${questionsJson}]]*/ '[]';
		try {
		    questions = JSON.parse(questions);
		    if(!Array.isArray(questions)) questions = [];
		} catch(e) {
		    console.error("questionsJson parsing error:", e);
		    questions = [];
		}
		
		// 시험 인덱스
		let testIdx = /*[[${test.testIdx}]]*/ 0;
		let startTime = new Date().toISOString();
		
		// 최대 20문제만 랜덤 선택
		function shuffleArray(arr) {
		    if(!Array.isArray(arr)) return [];
		    let copy = [...arr];
		    for(let i = copy.length - 1; i > 0; i--){
		        const j = Math.floor(Math.random() * (i + 1));
		        [copy[i], copy[j]] = [copy[j], copy[i]];
		    }
		    return copy;
		}
		
		questions = shuffleArray(questions).slice(0, 20);
		/*]]>*/
	</script>


    <!-- quizTest JS -->
    <script th:src="@{/js/quizTest.js}"></script>
</body>
</html>
