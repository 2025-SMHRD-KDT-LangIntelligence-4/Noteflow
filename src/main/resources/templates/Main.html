<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" th:href="@{/css/header.css}" />
<link id="theme-css" rel="stylesheet" th:href="@{/css/Main.css}" />
<script>
document.addEventListener("DOMContentLoaded", () => {
  const themeLink = document.getElementById("theme-css");
  const themeToggleBtn = document.getElementById("theme-toggle-btn");

  // 저장된 모드 불러오기
  const savedTheme = localStorage.getItem("theme") || "light";

  // 로그인 여부 확인 (버튼이 없으면 로그아웃 상태로 판단)
  const isLoggedIn = !!themeToggleBtn;

  if (isLoggedIn) {
    // 로그인 상태에서는 저장된 테마 적용
    applyTheme(savedTheme);

    // 버튼 클릭 시 다크모드 전환
    themeToggleBtn.addEventListener("click", () => {
      const current = localStorage.getItem("theme") || "light";
      const next = current === "light" ? "dark" : "light";
      applyTheme(next);
    });
  } else {
    // 로그아웃 상태에서는 항상 라이트모드 적용
    applyTheme("light");
  }

  // ✅ 테마 적용 함수
  function applyTheme(mode) {
    if (mode === "dark") {
      themeLink.setAttribute("href", "/CSSDARK/Maindark.css");
      localStorage.setItem("theme", "dark");
      if (themeToggleBtn) {
        themeToggleBtn.classList.add("dark"); // 버튼 이동 클래스 추가
      }
    } else {
      themeLink.setAttribute("href", "/css/Main.css");
      localStorage.setItem("theme", "light");
      if (themeToggleBtn) {
        themeToggleBtn.classList.remove("dark"); // 기본 위치로 복귀
      }
    }
  }
});
</script>
<link rel="stylesheet" th:href="@{/css/footer.css}" />
	<meta name="_csrf" th:content="${_csrf.token}"/>
	<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>
<body>
<!-- 헤더 -->
    <div th:replace="fragments/header :: siteHeader"></div>
    
	<div class="full-location-container">
		<div class="ad-banner-wrapper">
		  <div class="ad-banner">
		    <div class="ad-slide fade">
		      <img class="ad-banner-img" th:src="@{/images/sns_thm.jpg}" alt="광고1" style="background:#0090CF;">
		      <a href="https://lms.smhrd.or.kr/home/main/indexMain" target="_blank" class="smhrd-link">페이지바로가기</a>
		    </div>
		    <div class="ad-slide fade">
		      <img class="ad-banner-img" 
		      src="https://blz-contentstack-images.akamaized.net/v3/assets/blt2477dcaf4ebd440c/blt12c582d9d58631b9/6504c4b7af4949338d926e6c/Masthead_Overwatch2_Logo.png" alt="광고2"
		      style="background:linear-gradient(180deg, #d5d5d5  0, #939393 100%);"
		      >
		      <a href="https://overwatch.blizzard.com/ko-kr/" target="_blank" class="ad2-link">소집에 응답하기</a>
		    </div>
		    <div class="ad-slide fade">
		      <img class="ad-banner-img" th:src="@{/images/logo2.png}" alt="광고3">
		    </div>
		
		    <!-- 좌우 버튼 -->
		    <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
		    <a class="next" onclick="plusSlides(1)">&#10095;</a>
		  </div>
		
		  <!-- 점 네비게이션 -->
		  <div class="dots">
		    <span class="dot" onclick="currentSlide(1)"></span>
		    <span class="dot" onclick="currentSlide(2)"></span>
		    <span class="dot" onclick="currentSlide(3)"></span>
		  </div>
		</div>
		
		<div class="ad-banner2-wrapper">
			<div class="ad-banner2">
				<div class="AI-comment-box">
					<div class="comment-box">
						<div class="schedule-alarm">
    						<span th:if="${nickname != null and nickname != ''}" th:text="|${nickname}님 |"></span>
    						<span th:if="${nickname == null or nickname == ''}"></span>
    						<span>오늘의 스케줄을</span>
    						<span>확인 해주세요</span>
						</div>
						<a th:href="@{/schedule}" class="goSchedule-btn">스케줄 확인하러가기</a>
					</div>
				</div>
				<div class="calander-box">
					<img th:src="@{/images/calendar.gif}" class="calander-img"/>
					
				</div>
			</div>
		</div>
		<div class="ad-banner3-wrapper">
			<div class="ad-banner3">
				<div class="market-img-box">
					<img th:src="@{/images/market.gif}" class="calander-img"/>
					
				</div>
				<div class="ad-temMarket">
					<div class="ad-temMarket-comment-box">
						<div class="ad-temMarket-comment">
							<span>다양한 템플릿을</span>
							<span>구매할 수 있어요!</span>
						</div>
						<a th:href="@{/schedule}" class="goSchedule-btn">템플릿 마켓가기</a>
					</div>
				</div>
				<div class="slide-wrapper">
					<div class="slide-container">
						<div class="slide-btn"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div th:replace="fragments/footer :: siteFooter"></div>
	<script>
		let slideIndex = 0;
		showSlides();
		
		function showSlides() {
		  const slides = document.querySelectorAll(".ad-slide");
		  const dots = document.querySelectorAll(".dot");
		
		  slides.forEach(s => s.style.display = "none");
		  dots.forEach(d => d.classList.remove("active"));
		
		  slideIndex++;
		  if (slideIndex > slides.length) { slideIndex = 1; }
		
		  slides[slideIndex - 1].style.display = "block";
		  dots[slideIndex - 1].classList.add("active");
		
		  setTimeout(showSlides, 4000); // 4초마다 자동 전환
		}
		
		// 수동 제어
		function plusSlides(n) {
		  showManualSlide(slideIndex += n);
		}
		
		function currentSlide(n) {
		  showManualSlide(slideIndex = n);
		}
		
		function showManualSlide(n) {
		  const slides = document.querySelectorAll(".ad-slide");
		  const dots = document.querySelectorAll(".dot");
		
		  if (n > slides.length) { slideIndex = 1; }
		  if (n < 1) { slideIndex = slides.length; }
		
		  slides.forEach(s => s.style.display = "none");
		  dots.forEach(d => d.classList.remove("active"));
		
		  slides[slideIndex - 1].style.display = "block";
		  dots[slideIndex - 1].classList.add("active");
		}
	</script>


</body>

</html>
