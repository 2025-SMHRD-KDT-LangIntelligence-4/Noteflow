<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<title>ìŠ¤ì¼€ì¤„ ê´€ë¦¬ ë‹¬ë ¥</title>

<link
	href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css"
	rel="stylesheet">
<script
	src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>

<link id="theme-css" rel="stylesheet" th:href="@{/css/schedule-manager.css}" />
<script>
document.addEventListener("DOMContentLoaded", () => {
  const themeLink = document.getElementById("theme-css");
  const themeToggleBtn = document.getElementById("theme-toggle-btn");

  // ì €ì¥ëœ ëª¨ë“œ ë¶ˆëŸ¬ì˜¤ê¸°
  const savedTheme = localStorage.getItem("theme") || "light";

  // ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸ (ë²„íŠ¼ì´ ì—†ìœ¼ë©´ ë¡œê·¸ì•„ì›ƒ ìƒíƒœë¡œ íŒë‹¨)
  const isLoggedIn = !!themeToggleBtn;

  if (isLoggedIn) {
    // ë¡œê·¸ì¸ ìƒíƒœì—ì„œëŠ” ì €ì¥ëœ í…Œë§ˆ ì ìš©
    applyTheme(savedTheme);

    // ë²„íŠ¼ í´ë¦­ ì‹œ ë‹¤í¬ëª¨ë“œ ì „í™˜
    themeToggleBtn.addEventListener("click", () => {
      const current = localStorage.getItem("theme") || "light";
      const next = current === "light" ? "dark" : "light";
      applyTheme(next);
    });
  } else {
    // ë¡œê·¸ì•„ì›ƒ ìƒíƒœì—ì„œëŠ” í•­ìƒ ë¼ì´íŠ¸ëª¨ë“œ ì ìš©
    applyTheme("light");
  }

  // âœ… í…Œë§ˆ ì ìš© í•¨ìˆ˜
  function applyTheme(mode) {
    if (mode === "dark") {
      themeLink.setAttribute("href", "/CSSDARK/schedule-manager.css");
      localStorage.setItem("theme", "dark");
      if (themeToggleBtn) {
        themeToggleBtn.classList.add("dark"); // ë²„íŠ¼ ì´ë™ í´ë˜ìŠ¤ ì¶”ê°€
      }
    } else {
      themeLink.setAttribute("href", "/css/schedule-manager.css");
      localStorage.setItem("theme", "light");
      if (themeToggleBtn) {
        themeToggleBtn.classList.remove("dark"); // ê¸°ë³¸ ìœ„ì¹˜ë¡œ ë³µê·€
      }
    }
  }
});
</script>
<link rel="stylesheet" th:href="@{/css/header.css}" />
<link rel="stylesheet" th:href="@{/css/footer.css}" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>

<body>
	<div th:replace="~{fragments/header :: siteHeader}"></div>

	<div class="location-container">
		<div class="main-content-wrapper">

			<div class="calendar-wrapper">
				<div class="calendar-container">
					<div id="calendar"></div>
				</div>
			</div>

			<div id="scheduleSidebar" class="schedule-sidebar">
				<div class="sidebar-section search-section">
					<h3>ì¼ì • ê²€ìƒ‰</h3>
					<div class="search-input-group">
						<input type="text" id="scheduleSearchInput"
							placeholder="ì œëª©, ë‚´ìš©ìœ¼ë¡œ ê²€ìƒ‰" />
						<button id="searchButton" class="icon-btn">ğŸ”</button>
						<button id="searchResetButton" class="icon-btn" title="ê²€ìƒ‰ ì´ˆê¸°í™”">âŸ²</button>
					</div>
				</div>
				<div>
					<button id="openDeleteCenterBtn" class="btn danger"
						style="margin-left: 8px;">ğŸ—‘ï¸ ì‚­ì œ</button>
					<button id="openTrashBtn" class="btn secondary" title="íœ´ì§€í†µ/ë³µêµ¬">â™»ï¸
						ë³µêµ¬</button>
				</div>
				<div class="sidebar-section filter-section">
					<h3>ì¹´í…Œê³ ë¦¬ í•„í„°</h3>
					<div class="filter-category-list" id="categoryFilterList">
						<span class="category-tag active" data-filter="all">#ì „ì²´</span> <span
							class="category-tag" data-filter="java">@Java</span> <span
							class="category-tag" data-filter="python">@Python</span> <span
							class="category-tag input-placeholder">+ ì§ì ‘ ì…ë ¥</span>
					</div>
				</div>

				<div class="sidebar-section temp-section">
					<h3>ì„ì‹œ ì €ì¥ ì¼ì •</h3>
					<div id="tempScheduleContainer" class="temp-schedule-list">
						<div class="no-temp-schedules">ì €ì¥ëœ ì„ì‹œ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</div>
					</div>
				</div>
			</div>

		</div>

	</div>

	<div th:replace="~{fragments/schedule-dropdown-ui :: quickAddModal}"></div>
	<div th:replace="~{fragments/schedule-dropdown-ui :: editModal}"></div>
	<script
		src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/locales/ko.global.min.js"></script>
	<script type="module" src="/js/schedule-utils.js"></script>
	<script type="module" src="/js/schedule-ui-dropdown.js"></script>
	<script type="module" src="/js/schedule-quick-add.js"></script>
	<script type="module" src="/js/schedule-manager.js"></script>
	<script type="module" src="/js/schedule-edit.js"></script>

	<div th:replace="~{fragments/footer :: siteFooter}"></div>
</body>
</html>