<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" th:href="@{/css/header.css}" />
<link rel="stylesheet" th:href="@{/css/footer.css}" />
<link id="theme-css" rel="stylesheet" th:href="@{/css/market.css}"/>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const themeLink = document.getElementById("theme-css");
  const themeToggleBtn = document.getElementById("theme-toggle-btn");

  // 저장된 모드 불러오기
  const savedTheme = localStorage.getItem("theme") || "light";

  // 로그인 여부 확인 (버튼이 없으면 로그아웃 상태로 판단)
  const isLoggedIn = !!themeToggleBtn;

  if (isLoggedIn) {
    // 로그인 상태에서는 저장된 테마 적용
    applyTheme(savedTheme);

    // 버튼 클릭 시 다크모드 전환
    themeToggleBtn.addEventListener("click", () => {
      const current = localStorage.getItem("theme") || "light";
      const next = current === "light" ? "dark" : "light";
      applyTheme(next);
    });
  } else {
    // 로그아웃 상태에서는 항상 라이트모드 적용
    applyTheme("light");
  }

  // ✅ 테마 적용 함수
  function applyTheme(mode) {
    if (mode === "dark") {
      themeLink.setAttribute("href", "/CSSDARK/market.css");
      localStorage.setItem("theme", "dark");
      if (themeToggleBtn) {
        themeToggleBtn.classList.add("dark"); // 버튼 이동 클래스 추가
      }
    } else {
      themeLink.setAttribute("href", "/css/market.css");
      localStorage.setItem("theme", "light");
      if (themeToggleBtn) {
        themeToggleBtn.classList.remove("dark"); // 기본 위치로 복귀
      }
    }
  }
});
</script>
	<meta name="_csrf" th:content="${_csrf.token}"/>
	<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
</head>
<body>
<div th:replace="fragments/header :: siteHeader"></div>
	<div class="full-container">
		<div class = "full-location-container">
			<div class="market-title-wrapper">
				<img th:src="@{/images/market.gif}" class="market-img"/>
				<div class="market-title">다양한 템플릿을 찾아봐요</div>
			</div>
			<div class="path-wrapper">
					<div class="path-desc">
						<div class="path-title">새김패스</div>
						<a class="buy-path-btn">구매하기</a>				
					</div>
			</div>
			<div class="temp-market-wrapper">
				<div class="temp-market-list">
					<div class="temp-btn">
						<img th:src="@{/images/screenshot.png}"class="temp-img"/>
						<div class="temp-info">
							<div class="temp-name"><img th:src="@{/images/default-profile.png}" class="profile-img"/>문제중심버전</div>
							<div class="price">무료</div>
							<div class="rating">★5.0</div>
						</div>
					</div>
					<div class="temp-btn">
						<img th:src="@{/images/screenshot2.png}"class="temp-img"/>
						<div class="temp-info">
							<div class="temp-name"><img th:src="@{/images/default-profile.png}" class="profile-img"/>학습 전부 기록버전</div>
							<div class="price">무료</div>
							<div class="rating">★3.2</div>
						</div>
					</div>
					<div class="temp-btn">
						<img th:src="@{/images/screenshot3.png}"class="temp-img"/>
						<div class="temp-info">
							<div class="temp-name"><img th:src="@{/images/default-profile.png}" class="profile-img"/>키워드 버전</div>
							<div class="price">무료</div>
							<div class="rating">★4.8</div>
						</div>
					</div>
					<div class="temp-btn">
						<img th:src="@{/images/screenshot4.png}"class="temp-img"/>
						<div class="temp-info">
							<div class="temp-name"><img th:src="@{/images/default-profile.png}" class="profile-img"/>인사이트 중심 버전</div>
							<div class="price">무료</div>
							<div class="rating">★4.7</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
<div th:replace="fragments/footer :: siteFooter"></div>
</body>
</html>